Name:           globalprotect-openconnect-cli
Version:        @VERSION@
Release:        @REVISION@
Summary:        A GlobalProtect VPN client powered by OpenConnect
Group:          Productivity/Networking/PPP

License:        GPL-3.0
URL:            https://github.com/Online122228/GlobalProtect-openconnect
Source:         @SOURCE@

BuildRequires:  make
BuildRequires:  libtool
BuildRequires:  autoconf
BuildRequires:  automake
BuildRequires:  gcc-c++
BuildRequires:  rust
BuildRequires:  cargo
BuildRequires:  pkg-config
BuildRequires:  openconnect-devel
BuildRequires:  (openssl-devel or libopenssl-devel)
BuildRequires:  wget
BuildRequires:  file
BuildRequires:  perl

%if 0%{?suse_version}
BuildRequires:  webkit2gtk3-devel
%else
BuildRequires:  webkit2gtk4.1-devel
%endif

BuildRequires:  (librsvg2-devel or librsvg-devel)

Requires:       vpnc-script
Conflicts:      (globalprotect-openconnect-snapshot or globalprotect-openconnect)

%global debug_package %{nil}

%description
A CLI for GlobalProtect VPN, based on OpenConnect, supports the SSO authentication method.

%prep
%setup

%build
# The injected RUSTFLAGS could fail the build
unset RUSTFLAGS
make build OFFLINE=@OFFLINE@ BUILD_FE=0

%install
%make_install

%files
%defattr(-,root,root)
%{_bindir}/*
%{_libexecdir}/gpclient/hipreport.sh

%dir /usr/lib/NetworkManager
%dir /usr/lib/NetworkManager/dispatcher.d
%dir /usr/lib/NetworkManager/dispatcher.d/pre-down.d

/usr/lib/NetworkManager/dispatcher.d/pre-down.d/gpclient.down
/usr/lib/NetworkManager/dispatcher.d/gpclient-nm-hook

%dir %{_libexecdir}
%dir %{_libexecdir}/gpclient
%changelog
* @DATE@ Leart Dukaj <leartdukaj@mail.de> - @VERSION@
- Bugfix and improvements
